{
  "app_name": "StreakSnap",
  "tagline": "Daily photo streaks with friends ‚Äî break it and you both lose",
  "description": "StreakSnap combines BeReal's authenticity with Snapchat's streak mechanics and adds mutual accountability. Users create shared streaks with friends where both must post a daily photo to keep the streak alive. Miss a day? You both lose. It's the social pressure that actually works.",
  "target_audience": "Gen Z and young millennials (16-28) who already use Snapchat streaks and BeReal, want lightweight social accountability, and are tired of overly monetized photo apps",
  "market_research": {
    "niche": "Daily Photo Streak Challenge with Friends",
    "market_size_estimate": "TAM: 100M+ users globally (social photo sharing app users). SAM: 10-20M users actively seeking daily photo challenge/streak features. Reasoning: BeReal alone has 1.1M+ reviews suggesting 10M+ downloads; Snapchat streaks feature has massive adoption; habit tracking with social accountability is a growing segment.",
    "pain_points": [
      {
        "description": "Users lose streaks despite completing daily challenges - streak tracking is unreliable across multiple apps",
        "frequency": 8,
        "severity": 9,
        "source": "Reddit/Web Search",
        "quotes": [
          "Anyone else having an issue getting their daily streak? Mine just comes up to remind when it's time and nothing to claim.",
          "Keep losing streaks even after doing the daily challenges - Does anyone have the same problem where you lose the streak even though you've done the daily challenges?"
        ]
      },
      {
        "description": "Excessive monetization and pay-to-win mechanics ruin user experience",
        "frequency": 7,
        "severity": 7,
        "source": "App Store Reviews (GuruShots, Photo Roulette)",
        "quotes": [
          "The premium is way to expensive now... i liked it when it was a one time cheap purchase",
          "Endless prompts to pay - They recently updated the app to prompt users to pay for items every time they open the app",
          "This was once an excellent app... Now it's a micro transaction, ai slop, marketplace"
        ]
      },
      {
        "description": "App bugs and reliability issues cause frustration and abandonment",
        "frequency": 6,
        "severity": 6,
        "source": "App Store Reviews (GuruShots, 500px)",
        "quotes": [
          "Buggy - the screen is a bit darker and completely unresponsive",
          "Lot of bugs - Great content, but no way to view content of interest without a lot of hassles",
          "Not sure of the intent, but the recent update has made the app and the website useless"
        ]
      },
      {
        "description": "Lack of friend-based streak accountability where both parties share responsibility",
        "frequency": 5,
        "severity": 7,
        "source": "Web Search (Reddit discussions)",
        "quotes": [
          "App that lets you and your friend keep a streak together and if one of you breaks it, you both lose it",
          "My friends and I see each others photo proof for habit streaks"
        ]
      },
      {
        "description": "Storage limitations and unexpected paywalls for basic features",
        "frequency": 4,
        "severity": 5,
        "source": "App Store Reviews (Amazon Photos)",
        "quotes": [
          "Stopped from not enough room to store from my phone and wants to upgrade for a monthly fee after advertising free storage"
        ]
      }
    ],
    "feature_requests": [
      {
        "name": "Reliable Streak Tracking",
        "description": "Streak system that accurately tracks daily completion and doesn't lose progress due to bugs or timing issues",
        "demand_score": 9,
        "source": "Reddit discussions on lost streaks"
      },
      {
        "name": "Shared Friend Streaks",
        "description": "Ability to create streaks with friends where both parties are accountable - if one breaks, both lose",
        "demand_score": 8,
        "source": "Reddit - users asking for mutual accountability features"
      },
      {
        "name": "Daily Photo Prompts",
        "description": "Community or random daily challenges like 'Show us your morning coffee' or 'What's on your desk'",
        "demand_score": 7,
        "source": "Web search - Hyper app, dayli app descriptions"
      },
      {
        "name": "Widget Support",
        "description": "Home screen widgets to view friends' photos and streak status without opening the app",
        "demand_score": 6,
        "source": "LiveIn app feature mentioned in description"
      },
      {
        "name": "Random Time Notifications",
        "description": "Random daily notification times to encourage authentic, in-the-moment photos rather than staged content",
        "demand_score": 7,
        "source": "BeReal and Picaday app descriptions"
      },
      {
        "name": "Privacy Controls",
        "description": "Options to keep habits private vs. share with friends, addressing concerns about constant photo sharing",
        "demand_score": 5,
        "source": "Reddit discussion on habit privacy"
      }
    ],
    "competitors": [
      {
        "name": "BeReal: Photos & Friends Daily",
        "rating": 4.8,
        "review_count": 1132102,
        "price_model": "free",
        "strengths": [
          "Massive user base with high engagement",
          "Simple, authentic photo-sharing concept",
          "Random daily timing creates authenticity",
          "Kid-friendly and easy to use"
        ],
        "weaknesses": [
          "No explicit streak tracking system",
          "Limited gamification features",
          "No friend accountability mechanics"
        ],
        "missing_features": [
          "Streak tracking",
          "Shared friend accountability",
          "Custom challenge prompts"
        ]
      },
      {
        "name": "Photo Roulette",
        "rating": 4.7,
        "review_count": 107958,
        "price_model": "freemium",
        "strengths": [
          "Fun social game mechanic",
          "Uses existing photos from phones",
          "Good for group play"
        ],
        "weaknesses": [
          "Premium pricing complaints",
          "Not focused on daily streaks",
          "More game than habit tracker"
        ],
        "missing_features": [
          "Daily streak system",
          "Habit tracking",
          "Photo challenges"
        ]
      },
      {
        "name": "GuruShots: Photography Game",
        "rating": 4.4,
        "review_count": 5167,
        "price_model": "freemium",
        "strengths": [
          "Large photography community (7M+ users)",
          "Gamified photography experience",
          "Competitive elements"
        ],
        "weaknesses": [
          "Aggressive monetization",
          "Buggy and unreliable",
          "Pay-to-win mechanics frustrate users",
          "Coin system perceived as scam"
        ],
        "missing_features": [
          "Friend-focused streaks",
          "Simple daily challenges",
          "Authenticity focus"
        ]
      },
      {
        "name": "LiveIn - Share Your Moment",
        "rating": 4.7,
        "review_count": 30509,
        "price_model": "free",
        "strengths": [
          "Widget integration for easy sharing",
          "Camera-first experience",
          "Close friends focus"
        ],
        "weaknesses": [
          "No streak gamification",
          "Limited challenge features"
        ],
        "missing_features": [
          "Streak tracking",
          "Daily challenges",
          "Accountability features"
        ]
      },
      {
        "name": "Selfie A Day - Everyday Photo",
        "rating": 4.7,
        "review_count": 3879,
        "price_model": "free",
        "strengths": [
          "Simple daily selfie tracking",
          "Time-lapse video creation",
          "Personal history documentation"
        ],
        "weaknesses": [
          "Solo experience only",
          "No social/friend features",
          "Limited to selfies"
        ],
        "missing_features": [
          "Social features",
          "Friend streaks",
          "Photo challenges"
        ]
      },
      {
        "name": "Retro ‚Äî Photos with Friends",
        "rating": 4.8,
        "review_count": 3300,
        "price_model": "free",
        "strengths": [
          "Editors' Choice recognition",
          "Friend-focused photo sharing",
          "Clean design"
        ],
        "weaknesses": [
          "Smaller user base",
          "Limited public reviews for analysis"
        ],
        "missing_features": [
          "Explicit streak tracking",
          "Gamification elements"
        ]
      },
      {
        "name": "Streaks",
        "rating": 4.5,
        "review_count": 0,
        "price_model": "paid",
        "strengths": [
          "Elegant design for Apple ecosystem",
          "One-time purchase ($6.99)",
          "Apple Watch integration"
        ],
        "weaknesses": [
          "Apple-only ecosystem",
          "Not photo-specific",
          "Limited social features"
        ],
        "missing_features": [
          "Photo-based tracking",
          "Friend accountability",
          "Cross-platform support"
        ]
      }
    ],
    "market_sentiment": "positive",
    "market_sentiment_score": 3.8,
    "trends": [
      "Authenticity over curation - users prefer real, unfiltered moments (BeReal's success)",
      "Gamification of daily habits through streaks and challenges",
      "Social accountability for habit formation - friends keeping each other on track",
      "Widget-based quick sharing without opening apps",
      "Random timing notifications to prevent staged content",
      "Growing frustration with aggressive monetization in photo apps"
    ],
    "monetization_insights": [
      "One-time purchase model ($6.99 like Streaks) is preferred over subscriptions by users",
      "Freemium with reasonable premium features works better than aggressive microtransactions",
      "Users actively complain about apps that became 'pay-to-win' or have 'endless prompts to pay'",
      "Storage-based monetization (Amazon Photos) creates friction when free limits are hit",
      "Coin/credit systems (GuruShots) are perceived negatively as 'scams' when not transparent",
      "Social apps with streak features could monetize through: custom challenges, streak recovery, private groups, or cosmetic customizations"
    ],
    "raw_data_summary": "Analyzed 8 App Store listings with combined 1.3M+ reviews, plus web search results covering Reddit discussions, Medium articles, and competitor app descriptions. Key findings: BeReal dominates the authentic daily photo space but lacks streak gamification; users across multiple apps report frustration with lost streaks due to bugs; there's clear demand for friend-based accountability streaks that don't exist in current offerings; aggressive monetization is a major pain point driving negative reviews."
  },
  "strategy": {
    "niche": "Daily Photo Streak Challenge with Friends",
    "opportunities": [
      {
        "name": "StreakSnap",
        "tagline": "Daily photo streaks with friends ‚Äî break it and you both lose",
        "description": "StreakSnap combines BeReal's authenticity with Snapchat's streak mechanics and adds mutual accountability. Users create shared streaks with friends where both must post a daily photo to keep the streak alive. Miss a day? You both lose. It's the social pressure that actually works.",
        "target_audience": "Gen Z and young millennials (16-28) who already use Snapchat streaks and BeReal, want lightweight social accountability, and are tired of overly monetized photo apps",
        "core_features": [
          "Shared friend streaks with mutual accountability ‚Äî if one person misses, both lose the streak",
          "Random daily notification window (2-hour window) to encourage authentic, in-the-moment photos",
          "Daily themed photo prompts ('Show your lunch', 'Something blue', 'Your view right now')",
          "Streak calendar heatmap showing your consistency history with friends",
          "Push notification reminders with streak-at-risk warnings using loss aversion messaging",
          "Friend feed showing today's photos from active streaks only",
          "Streak recovery token (earn 1 free recovery per 30-day streak, or purchase)",
          "Share streak milestones as Instagram Stories / TikTok cards"
        ],
        "differentiator": "The only app where streaks are mutual ‚Äî your friend's commitment keeps YOUR streak alive too. This creates genuine social accountability that solo streak apps and Snapchat (where streaks are just sending anything) can't match.",
        "monetization": "Freemium ‚Äî free for up to 3 active streaks with friends. Premium ($2.99/month or $19.99/year) unlocks unlimited streaks, custom prompts, streak recovery tokens, and cosmetic streak badges. One-time streak recovery: $0.99. No ads ever.",
        "feasibility": "moderate",
        "estimated_dev_days": 12,
        "risk_factors": [
          "Network effect dependency ‚Äî app is valueless without friends joining, cold start problem",
          "Notification fatigue if users join too many streaks",
          "BeReal could add streak features and crush the niche overnight",
          "Mutual streak loss could frustrate users and cause churn if a friend goes inactive"
        ],
        "confidence_score": 0.85
      },
      {
        "name": "PhotoPact",
        "tagline": "Make a pact. Take a photo. Every single day.",
        "description": "PhotoPact turns daily photography into a binding social contract. Create a 'pact' with 2-5 friends, choose a duration (7, 30, or 100 days), and commit to a daily photo theme. Everyone sees proof. Everyone stays accountable. Complete the pact and unlock a shared memory album and shareable achievement card.",
        "target_audience": "Young adults (20-35) interested in habit formation, photography improvement, or maintaining long-distance friendships through daily visual check-ins",
        "core_features": [
          "Pact creation with friends ‚Äî set duration (7/30/100 days), theme, and daily deadline",
          "Photo proof feed where all pact members see each other's daily submissions",
          "Completion rewards ‚Äî shared memory album and shareable achievement card upon finishing a pact",
          "Streak counter with progress bar showing days completed vs. remaining",
          "Late submission grace period (2 hours past deadline) with warning notification to group",
          "Pact history gallery ‚Äî browse completed pacts as visual time capsules"
        ],
        "differentiator": "Finite commitment model ‚Äî pacts have clear start and end dates, making them less intimidating than infinite streaks. The completion reward (shared album + achievement) gives a tangible payoff that infinite streaks never provide.",
        "monetization": "Freemium ‚Äî 1 active pact free. Premium ($3.99/month or $29.99/year) unlocks unlimited active pacts, custom themes, extended pact durations (up to 365 days), and premium achievement card designs. No ads.",
        "feasibility": "moderate",
        "estimated_dev_days": 14,
        "risk_factors": [
          "Pact completion rates may be low if groups are unreliable, leading to frustration",
          "More complex onboarding than a simple streak app ‚Äî needs friend invites and pact setup",
          "Content moderation needed since photos are shared in groups (Apple Guideline 1.2)",
          "Finite pacts mean users might churn between pacts if re-engagement isn't handled well"
        ],
        "confidence_score": 0.72
      },
      {
        "name": "DailyLens",
        "tagline": "One prompt. One photo. Every day.",
        "description": "DailyLens delivers a single creative photography prompt each day and challenges you to capture it. Build your personal streak, compare your interpretation with the community, and watch your photography skills grow over time. It's Wordle meets photography ‚Äî simple, daily, addictive.",
        "target_audience": "Amateur photographers and creatively curious adults (22-40) who want a low-pressure daily creative habit without the social anxiety of friend-based accountability",
        "core_features": [
          "One daily photo prompt delivered at a consistent user-chosen time",
          "Personal streak tracker with calendar heatmap and longest-streak badge",
          "Community gallery ‚Äî see how others interpreted the same prompt (anonymous or named)",
          "Monthly recap video/slideshow auto-generated from your 30 daily photos",
          "Streak freeze ‚Äî earn 1 free freeze per 14-day streak (skip a day without losing progress)",
          "Prompt categories: nature, urban, food, people, abstract, color-themed"
        ],
        "differentiator": "Solo-first with optional community ‚Äî no friend pressure, no mutual accountability anxiety. The single daily prompt creates a Wordle-like ritual that's easy to maintain. Monthly recap gives tangible creative output.",
        "monetization": "Freemium ‚Äî free with basic prompts and 7-day streak history. Premium ($1.99/month or $14.99/year) unlocks full streak history, monthly recap videos, prompt category selection, custom reminders, and ad-free community gallery. Streak freeze pack (3 freezes): $0.99.",
        "feasibility": "easy",
        "estimated_dev_days": 8,
        "risk_factors": [
          "Lower viral coefficient without social/friend mechanics ‚Äî growth depends on content marketing",
          "Prompt quality must stay high or users disengage ‚Äî needs curation or AI generation pipeline",
          "Solo apps have lower retention than social apps ‚Äî median D30 retention likely 8-12%",
          "Photography prompt apps exist (though none dominate) ‚Äî differentiation is softer"
        ],
        "confidence_score": 0.78
      }
    ],
    "selected_opportunity": {
      "name": "StreakSnap",
      "tagline": "Daily photo streaks with friends ‚Äî break it and you both lose",
      "description": "StreakSnap combines BeReal's authenticity with Snapchat's streak mechanics and adds mutual accountability. Users create shared streaks with friends where both must post a daily photo to keep the streak alive. Miss a day? You both lose. It's the social pressure that actually works.",
      "target_audience": "Gen Z and young millennials (16-28) who already use Snapchat streaks and BeReal, want lightweight social accountability, and are tired of overly monetized photo apps",
      "core_features": [
        "Shared friend streaks with mutual accountability ‚Äî if one person misses, both lose the streak",
        "Random daily notification window (2-hour window) to encourage authentic, in-the-moment photos",
        "Daily themed photo prompts ('Show your lunch', 'Something blue', 'Your view right now')",
        "Streak calendar heatmap showing your consistency history with friends",
        "Push notification reminders with streak-at-risk warnings using loss aversion messaging",
        "Friend feed showing today's photos from active streaks only",
        "Streak recovery token (earn 1 free recovery per 30-day streak, or purchase)",
        "Share streak milestones as Instagram Stories / TikTok cards"
      ],
      "differentiator": "The only app where streaks are mutual ‚Äî your friend's commitment keeps YOUR streak alive too. This creates genuine social accountability that solo streak apps and Snapchat (where streaks are just sending anything) can't match.",
      "monetization": "Freemium ‚Äî free for up to 3 active streaks with friends. Premium ($2.99/month or $19.99/year) unlocks unlimited streaks, custom prompts, streak recovery tokens, and cosmetic streak badges. One-time streak recovery: $0.99. No ads ever.",
      "feasibility": "moderate",
      "estimated_dev_days": 12,
      "risk_factors": [
        "Network effect dependency ‚Äî app is valueless without friends joining, cold start problem",
        "Notification fatigue if users join too many streaks",
        "BeReal could add streak features and crush the niche overnight",
        "Mutual streak loss could frustrate users and cause churn if a friend goes inactive"
      ],
      "confidence_score": 0.85
    },
    "rejected_features": [
      {
        "feature": "Home Screen Widgets (WidgetKit)",
        "reason": "WidgetKit requires native iOS modules and Swift code that cannot be built with Expo SDK 54 managed workflow. Would need a custom dev client or bare workflow, significantly increasing development complexity and maintenance burden.",
        "source": "LiveIn app's widget feature"
      },
      {
        "feature": "Apple Watch Integration",
        "reason": "WatchOS apps require native Swift development and cannot be built with React Native or Expo. The Streaks app's Apple Watch feature is not replicable in our stack.",
        "source": "Streaks app feature"
      },
      {
        "feature": "Time-Lapse Video Generation from Daily Photos",
        "reason": "On-device video generation from image sequences requires heavy native processing (FFmpeg or AVFoundation). While technically possible with expo-av or a cloud pipeline, it adds significant complexity for an MVP. Deferred to post-launch enhancement.",
        "source": "Selfie A Day app feature"
      },
      {
        "feature": "Real-Time Photo Reactions / Live Comments",
        "reason": "Real-time features require WebSocket infrastructure, significantly increasing backend complexity and hosting costs. Not justified for MVP when simple push notifications and pull-to-refresh cover the core use case.",
        "source": "General social app pattern"
      }
    ],
    "market_positioning": "Position against BeReal by owning 'accountability' ‚Äî BeReal is about authenticity but has zero consequence for missing a day. Position against Snapchat streaks by owning 'meaning' ‚Äî Snapchat streaks are just sending any image to maintain a number, while StreakSnap streaks require themed, genuine photos. Position against GuruShots by owning 'fairness' ‚Äî no pay-to-win, no coin scams, no aggressive monetization. The tagline should emphasize the mutual accountability angle: 'The streak app where your friends actually matter.' Pricing must stay user-friendly (under $4/month) given the market's strong anti-monetization sentiment. Launch with a referral program where inviting a friend gives both users a free streak recovery token."
  },
  "design_system": {
    "colors": [
      {
        "name": "streak_fire",
        "hex": "#FF6B35",
        "usage": "Primary brand color, streak flames, active streak indicators, key CTAs"
      },
      {
        "name": "electric_violet",
        "hex": "#8B5CF6",
        "usage": "Secondary accent, gradient endpoints, premium features, celebration moments"
      },
      {
        "name": "pulse_blue",
        "hex": "#3B82F6",
        "usage": "Notification badges, links, interactive elements, 'post now' urgency"
      },
      {
        "name": "success_green",
        "hex": "#10B981",
        "usage": "Completed daily posts, streak milestones achieved, positive states"
      },
      {
        "name": "warning_amber",
        "hex": "#F59E0B",
        "usage": "Streak at-risk warnings, 30-minute remaining alerts, caution states"
      },
      {
        "name": "danger_red",
        "hex": "#EF4444",
        "usage": "Broken streaks, missed posts, critical alerts, loss indicators"
      },
      {
        "name": "oled_black",
        "hex": "#050505",
        "usage": "Primary background, OLED deep dark mode base"
      },
      {
        "name": "surface_dark",
        "hex": "#121212",
        "usage": "Elevated cards, glassmorphism base, modal backgrounds"
      },
      {
        "name": "surface_elevated",
        "hex": "#1E1E1E",
        "usage": "Input fields, buttons (secondary), navigation bars"
      },
      {
        "name": "text_primary",
        "hex": "#FAFAFA",
        "usage": "Main headings, streak numbers, primary text on dark"
      },
      {
        "name": "text_secondary",
        "hex": "#A3A3A3",
        "usage": "Captions, timestamps, secondary information"
      },
      {
        "name": "text_muted",
        "hex": "#737373",
        "usage": "Placeholder text, disabled states, tertiary info"
      },
      {
        "name": "glass_white",
        "hex": "#FFFFFF",
        "usage": "Glassmorphism overlay (8% opacity), borders, dividers"
      },
      {
        "name": "gradient_haze_start",
        "hex": "#FF6B35",
        "usage": "AI gradient haze start - streak celebration, onboarding"
      },
      {
        "name": "gradient_haze_end",
        "hex": "#EC4899",
        "usage": "AI gradient haze end - blends with violet for dreamy effects"
      }
    ],
    "typography": [
      {
        "name": "streak_hero",
        "font_size": 72,
        "font_weight": "bold",
        "line_height": 0.9
      },
      {
        "name": "display_large",
        "font_size": 36,
        "font_weight": "bold",
        "line_height": 1.1
      },
      {
        "name": "heading1",
        "font_size": 24,
        "font_weight": "semibold",
        "line_height": 1.2
      },
      {
        "name": "heading2",
        "font_size": 20,
        "font_weight": "semibold",
        "line_height": 1.3
      },
      {
        "name": "body",
        "font_size": 16,
        "font_weight": "normal",
        "line_height": 1.5
      },
      {
        "name": "body_medium",
        "font_size": 15,
        "font_weight": "medium",
        "line_height": 1.4
      },
      {
        "name": "caption",
        "font_size": 13,
        "font_weight": "normal",
        "line_height": 1.4
      },
      {
        "name": "micro",
        "font_size": 11,
        "font_weight": "medium",
        "line_height": 1.2
      }
    ],
    "spacing": [
      {
        "name": "xs",
        "value": 4
      },
      {
        "name": "sm",
        "value": 8
      },
      {
        "name": "md",
        "value": 16
      },
      {
        "name": "lg",
        "value": 24
      },
      {
        "name": "xl",
        "value": 32
      },
      {
        "name": "2xl",
        "value": 48
      },
      {
        "name": "3xl",
        "value": 64
      }
    ],
    "components": [
      {
        "name": "streak_card",
        "border_radius": 20,
        "padding": "p-4",
        "shadow": "shadow-lg shadow-streak_fire/10",
        "notes": "Glassmorphism with backdrop-blur-xl, gradient border for active streaks, haptic pulse on tap"
      },
      {
        "name": "photo_frame",
        "border_radius": 16,
        "padding": "p-1",
        "shadow": "shadow-md shadow-black/50",
        "notes": "Gradient border (fire to violet) for posted photos, subtle inner shadow for depth"
      },
      {
        "name": "button_primary",
        "border_radius": 9999,
        "padding": "px-8 py-4",
        "shadow": "shadow-lg shadow-streak_fire/30",
        "notes": "Gradient background (fire to pink), min 44px height, haptic-visual sync on press"
      },
      {
        "name": "button_secondary",
        "border_radius": 9999,
        "padding": "px-6 py-3",
        "shadow": "",
        "notes": "Glassmorphism with border, transparent background, 1px white/20 border"
      },
      {
        "name": "button_urgent",
        "border_radius": 16,
        "padding": "px-6 py-4",
        "shadow": "shadow-xl shadow-warning_amber/40",
        "notes": "Pulsing animation, amber gradient, used for 'post now' CTA when streak at risk"
      },
      {
        "name": "input_field",
        "border_radius": 12,
        "padding": "px-4 py-3",
        "shadow": "",
        "notes": "Glassmorphism background, no visible border, placeholder in text_muted"
      },
      {
        "name": "modal_sheet",
        "border_radius": 24,
        "padding": "p-6",
        "shadow": "shadow-2xl shadow-black/60",
        "notes": "Bottom sheet style, glassmorphism with heavy blur, drag handle at top"
      },
      {
        "name": "heatmap_cell",
        "border_radius": 4,
        "padding": "",
        "shadow": "",
        "notes": "4x4px cells in bento grid, opacity varies by streak activity (0.1 to 1.0)"
      },
      {
        "name": "friend_avatar",
        "border_radius": 9999,
        "padding": "",
        "shadow": "shadow-md shadow-black/40",
        "notes": "Ring border shows streak status: green=posted, amber=pending, red=missed"
      },
      {
        "name": "badge",
        "border_radius": 9999,
        "padding": "px-3 py-1",
        "shadow": "",
        "notes": "Small status indicators, glassmorphism, micro typography"
      },
      {
        "name": "toast_notification",
        "border_radius": 12,
        "padding": "px-4 py-3",
        "shadow": "shadow-lg shadow-black/30",
        "notes": "Slides from top, glassmorphism, auto-dismiss after 3s, haptic tap"
      },
      {
        "name": "bento_card",
        "border_radius": 16,
        "padding": "p-4",
        "shadow": "shadow-sm shadow-black/20",
        "notes": "Grid cells for friend feed, varying sizes (1x1, 2x1, 1x2), glassmorphism"
      }
    ],
    "overall_style": "OLED Dark with Glassmorphism and AI Gradient Haze accents ‚Äî A photo-first, dark-optimized design that makes user photos pop against true black backgrounds. Glassmorphic overlays create depth without distraction, while warm gradient accents (fire orange to electric violet) energize the streak experience. Bento grid layouts organize the friend feed with visual hierarchy.",
    "dark_mode_palette": [
      {
        "name": "oled_black",
        "hex": "#050505",
        "usage": "Primary background (true black for OLED power savings)"
      },
      {
        "name": "surface_dark",
        "hex": "#121212",
        "usage": "Elevated surfaces, cards, modals"
      },
      {
        "name": "surface_elevated",
        "hex": "#1E1E1E",
        "usage": "Highest elevation, input fields, buttons"
      },
      {
        "name": "glass_overlay",
        "hex": "#FFFFFF",
        "usage": "8% opacity overlay for glassmorphism effect"
      },
      {
        "name": "border_subtle",
        "hex": "#FFFFFF",
        "usage": "12% opacity for subtle borders and dividers"
      },
      {
        "name": "gradient_fire_glow",
        "hex": "#FF6B35",
        "usage": "20% opacity glow behind active streak elements"
      }
    ],
    "nativewind_config": {
      "theme": {
        "extend": {
          "colors": {
            "streak": {
              "fire": "#FF6B35",
              "fire_light": "#FF8F66",
              "glow": "rgba(255, 107, 53, 0.2)"
            },
            "electric": {
              "violet": "#8B5CF6",
              "pink": "#EC4899",
              "blue": "#3B82F6"
            },
            "status": {
              "success": "#10B981",
              "warning": "#F59E0B",
              "danger": "#EF4444"
            },
            "surface": {
              "black": "#050505",
              "dark": "#121212",
              "elevated": "#1E1E1E",
              "card": "#262626"
            },
            "text": {
              "primary": "#FAFAFA",
              "secondary": "#A3A3A3",
              "muted": "#737373"
            },
            "glass": {
              "white": "rgba(255, 255, 255, 0.08)",
              "border": "rgba(255, 255, 255, 0.12)",
              "hover": "rgba(255, 255, 255, 0.16)"
            }
          },
          "fontFamily": {
            "display": [
              "System",
              "sans-serif"
            ],
            "body": [
              "System",
              "sans-serif"
            ]
          },
          "borderRadius": {
            "card": "20px",
            "modal": "24px",
            "input": "12px",
            "cell": "4px"
          },
          "boxShadow": {
            "glow_fire": "0 0 40px rgba(255, 107, 53, 0.3)",
            "glow_violet": "0 0 40px rgba(139, 92, 246, 0.3)",
            "glass": "0 8px 32px rgba(0, 0, 0, 0.4)",
            "elevated": "0 4px 16px rgba(0, 0, 0, 0.3)"
          },
          "backdropBlur": {
            "glass": "20px",
            "heavy": "40px"
          },
          "animation": {
            "pulse_slow": "pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite",
            "glow": "glow 2s ease-in-out infinite alternate",
            "slide_up": "slideUp 0.3s ease-out",
            "fade_in": "fadeIn 0.2s ease-out"
          },
          "keyframes": {
            "glow": {
              "0%": {
                "boxShadow": "0 0 20px rgba(255, 107, 53, 0.3)"
              },
              "100%": {
                "boxShadow": "0 0 40px rgba(255, 107, 53, 0.5)"
              }
            },
            "slideUp": {
              "0%": {
                "transform": "translateY(20px)",
                "opacity": "0"
              },
              "100%": {
                "transform": "translateY(0)",
                "opacity": "1"
              }
            },
            "fadeIn": {
              "0%": {
                "opacity": "0"
              },
              "100%": {
                "opacity": "1"
              }
            }
          }
        }
      }
    },
    "design_notes": [
      "OLED Deep Dark is the primary mode ‚Äî true black (#050505) backgrounds maximize photo visibility and save battery on OLED screens",
      "Glassmorphism implemented via backdrop-blur-xl with 8% white overlay ‚Äî creates depth without obscuring photos",
      "AI Gradient Haze used for celebration moments (streak milestones) ‚Äî fire orange to electric pink creates warm, energetic glow",
      "Bento Grid layout for friend feed ‚Äî asymmetric grid (2+1, 1+2 patterns) creates visual interest while maintaining scannability",
      "Streak numbers use 72px bold typography ‚Äî creates 'gamification' moment that rewards consistency",
      "Heatmap calendar uses opacity-based cells ‚Äî darker cells = posted days, creates satisfying visual of consistency",
      "All touch targets minimum 48x48px ‚Äî exceeds 44px WCAG minimum for better mobile ergonomics",
      "Haptic-visual sync: fire gradient pulses with light haptic on streak-at-risk warnings",
      "Status ring on friend avatars: green ring = posted today, amber = pending, red = missed ‚Äî instant visual accountability",
      "No pure white text (#FFFFFF) ‚Äî using #FAFAFA reduces eye strain on OLED in low-light conditions",
      "Gradient CTAs (fire to pink) create urgency and warmth ‚Äî differentiates from cool-toned competitors",
      "Premium features use electric violet accent ‚Äî subtle visual hierarchy without paywall friction"
    ]
  },
  "ux_architecture": {
    "screens": [
      {
        "name": "index",
        "route": "app/index.tsx",
        "description": "Smart router: checks AsyncStorage for onboarding completion, then auth state. Routes to onboarding (first launch), guest-home (no account), or protected home (authenticated). No UI ‚Äî pure redirect logic.",
        "components": [
          "ActivityIndicator",
          "useEffect redirect logic"
        ],
        "api_calls": []
      },
      {
        "name": "onboarding",
        "route": "app/(auth)/onboarding.tsx",
        "description": "3-step horizontal swipeable onboarding. Step 1: Lottie animation of two phones snapping photos simultaneously ‚Äî headline 'Streak Together' ‚Äî subtext 'Daily photo streaks with your best friends. Miss a day? You both lose.' Step 2: Illustration of notification bell with clock ‚Äî headline 'Stay Real' ‚Äî subtext 'Random 2-hour windows keep your photos authentic and in-the-moment.' Step 3: Calendar heatmap illustration ‚Äî headline 'Build Your Legacy' ‚Äî subtext 'Watch your streak calendar grow. Earn recovery tokens at 30-day milestones.' Bottom: dot indicators (#FFFFFF 8px circles, active dot #FF6B35), 'Get Started' button on step 3 (#FF6B35 bg, #FFFFFF text, rounded-2xl, h-14). Skip link on steps 1-2 (text-white/60).",
        "components": [
          "ScrollView horizontal pagingEnabled",
          "Animated.View for dot indicators",
          "Pressable 'Get Started'",
          "Pressable 'Skip'",
          "LottieView or Image per step"
        ],
        "api_calls": []
      },
      {
        "name": "login",
        "route": "app/(auth)/login.tsx",
        "description": "Dark login screen (#0A0A0A bg). Top: StreakSnap logo (flame icon üî• + wordmark in #FF6B35, 32px). Email input (bg-white/10 border border-white/20 rounded-xl h-12 px-4 text-white placeholder-white/40). Password input same style with eye toggle. 'Log In' button (#FF6B35 bg, w-full h-14 rounded-2xl, font-bold text-white text-lg). Divider '‚Äî or ‚Äî' in text-white/30. Apple Sign In button (bg-white text-black h-14 rounded-2xl with Apple logo). Bottom: 'Don't have an account? Sign Up' link (text-white/60, 'Sign Up' in text-[#FF6B35]).",
        "components": [
          "TextInput email",
          "TextInput password",
          "Pressable 'Log In'",
          "AppleSignInButton",
          "Pressable navigate to register",
          "KeyboardAvoidingView"
        ],
        "api_calls": [
          "POST /api/auth/login",
          "POST /api/auth/apple"
        ]
      },
      {
        "name": "register",
        "route": "app/(auth)/register.tsx",
        "description": "Dark registration screen (#0A0A0A bg). Top: 'Join StreakSnap' text (text-white text-2xl font-bold). Username input (bg-white/10, validates uniqueness on blur via API, shows green checkmark or red X). Email input. Password input with strength indicator (4 bars: weak #EF4444, fair #F59E0B, good #22C55E, strong #22C55E). Confirm password input. 'Create Account' button (#FF6B35 bg h-14 rounded-2xl). Apple Sign In button. Bottom: 'Already have an account? Log In' link. After success: auto-login + navigate to protected home with confetti animation.",
        "components": [
          "TextInput username",
          "TextInput email",
          "TextInput password",
          "TextInput confirmPassword",
          "PasswordStrengthBar",
          "Pressable 'Create Account'",
          "AppleSignInButton",
          "ConfettiCannon on success"
        ],
        "api_calls": [
          "POST /api/auth/register",
          "GET /api/auth/check-username/:username"
        ]
      },
      {
        "name": "guest-home",
        "route": "app/(auth)/guest-home.tsx",
        "description": "Limited guest experience (#0A0A0A bg). Top: 'StreakSnap' logo + 'Guest Mode' badge (bg-white/10 rounded-full px-3 py-1 text-xs text-white/60). UsageBadge showing '3 free peeks remaining' or '2 remaining' etc (bg-[#FF6B35]/20 text-[#FF6B35]). Sample streak feed with 3 blurred placeholder photos (BlurView intensity 80) showing mock streak data. Each card: blurred photo + 'üî• 12 day streak' overlay + 'Sign up to start your own streaks' CTA. Bottom CTA banner: gradient bg (#FF6B35 to #FF8C61), 'Start Your First Streak' button (bg-white text-[#FF6B35] h-12 rounded-xl font-bold). Tapping any blurred photo decrements guest counter; at 0 shows signup modal.",
        "components": [
          "UsageBadge",
          "BlurView placeholder cards",
          "CTABanner gradient",
          "Pressable 'Start Your First Streak'",
          "Modal signup prompt at 0 uses"
        ],
        "api_calls": []
      },
      {
        "name": "protected-layout",
        "route": "app/(protected)/_layout.tsx",
        "description": "Auth guard layout. Checks isAuthenticated from AuthContext ‚Äî if false, redirects to login. Renders Slot (NOT Stack or Tabs) + custom bottom tab bar. Tab bar: bg-[#0A0A0A] border-t border-white/10 h-20 pb-6 pt-2 flex-row justify-around items-center. 4 tab items. Active tab: icon #FF6B35 + label text-[#FF6B35] text-xs font-semibold. Inactive: icon #FFFFFF60 + label text-white/40 text-xs. Haptic feedback (light impact) on tab press.",
        "components": [
          "Slot",
          "View custom tab bar",
          "Pressable tab items x4",
          "Ionicons per tab",
          "expo-haptics light impact"
        ],
        "api_calls": []
      },
      {
        "name": "home",
        "route": "app/(protected)/home.tsx",
        "description": "Main feed screen (#0A0A0A bg). Top bar: 'StreakSnap' wordmark (text-[#FF6B35] text-xl font-bold) left, notification bell icon (Ionicons 'notifications-outline' 24px white) right with red dot badge if unread. If inside active notification window: orange pulsing banner at top ‚Äî 'üì∏ Snap window open! 1h 23m left' (bg-[#FF6B35]/20 text-[#FF6B35] rounded-xl mx-4 p-3, Animated.View pulsing opacity 0.7‚Üî1.0). Today's prompt card below banner: bg-white/5 rounded-2xl p-4 mx-4 ‚Äî prompt text in text-white text-lg font-semibold (e.g., 'Show your lunch üçï'), subtext 'Tap to snap' in text-white/50. Active streaks feed (FlatList vertical): each card is StreakFeedCard ‚Äî friend's photo (w-full aspect-[4/3] rounded-2xl), below: Row with friend avatar (32px circle), username (text-white font-semibold), streak count badge ('üî• 47' in bg-[#FF6B35]/20 text-[#FF6B35] rounded-full px-3 py-1), time ago (text-white/40 text-xs). If friend hasn't posted yet today: grayed placeholder with '‚è≥ Waiting for @username'. If YOU haven't posted: your card slot shows camera icon + 'Your turn! Snap now' in text-[#FF6B35]. Empty state (no streaks): illustration + 'Add friends to start streaking' + 'Add Friends' button.",
        "components": [
          "FlatList StreakFeedCard",
          "PromptCard",
          "SnapWindowBanner animated",
          "NotificationBell with badge",
          "EmptyState illustration"
        ],
        "api_calls": [
          "GET /api/streaks/feed",
          "GET /api/prompts/today",
          "GET /api/notifications/unread-count"
        ]
      },
      {
        "name": "camera",
        "route": "app/(protected)/camera.tsx",
        "description": "Full-screen camera capture (#000000 bg). Top: back arrow (Ionicons 'chevron-back' white 28px) left, flash toggle (Ionicons 'flash-outline'/'flash' 24px) right, camera flip (Ionicons 'camera-reverse-outline' 24px) far right. Center: live camera preview (expo-camera, aspect ratio 4:3, rounded-3xl overflow hidden mx-4). Today's prompt floating at top of preview in semi-transparent pill (bg-black/50 backdrop-blur rounded-full px-4 py-2 text-white text-sm font-medium). Bottom: large capture button (w-20 h-20 rounded-full border-4 border-white, inner circle w-16 h-16 rounded-full bg-white). Scale animation on press (0.9‚Üí1.0). After capture: preview with 'Retake' (text-white/60) and 'Send' (#FF6B35 bg rounded-2xl h-12 px-8) buttons. Streak selector: horizontal ScrollView of friend avatars with checkmarks to select which streaks to send to. 'Send to All' shortcut button.",
        "components": [
          "Camera expo-camera",
          "Pressable capture button with Animated.View",
          "Pressable flash toggle",
          "Pressable camera flip",
          "Image preview after capture",
          "ScrollView friend selector",
          "Pressable 'Send' / 'Retake'"
        ],
        "api_calls": [
          "POST /api/streaks/snap (multipart/form-data)",
          "GET /api/streaks/active"
        ]
      },
      {
        "name": "friends",
        "route": "app/(protected)/friends.tsx",
        "description": "Friends management screen (#0A0A0A bg). Top: 'Friends' title (text-white text-2xl font-bold) left, 'Add' button (Ionicons 'person-add-outline' 24px #FF6B35) right. Search bar (bg-white/10 rounded-xl h-11 px-4 text-white placeholder-white/40, Ionicons 'search' 20px white/40 left). Tabs row below search: 'Active Streaks' | 'All Friends' | 'Requests' (active tab: text-[#FF6B35] border-b-2 border-[#FF6B35], inactive: text-white/50). Active Streaks tab: FlatList of FriendStreakCard ‚Äî Row with avatar (44px circle), username (text-white font-semibold), streak fire + count ('üî• 23'), streak status pill (green 'Both posted' / yellow 'Waiting on you' / red 'At risk ‚Äî 2h left'). Swipe left on card reveals 'Nudge üëâ' action (bg-[#FF6B35]). All Friends tab: simple list with avatar, username, 'Start Streak' button (border border-[#FF6B35] text-[#FF6B35] rounded-full px-4 py-1). Requests tab: incoming requests with Accept/Decline buttons. Add friend modal: search by username, shows results, send request button.",
        "components": [
          "TextInput search",
          "Pressable tab selectors",
          "FlatList FriendStreakCard",
          "Swipeable 'Nudge'",
          "Modal add friend",
          "Pressable 'Accept'/'Decline' requests"
        ],
        "api_calls": [
          "GET /api/friends",
          "GET /api/friends/requests",
          "POST /api/friends/request",
          "PUT /api/friends/request/:id/accept",
          "DELETE /api/friends/request/:id/decline",
          "POST /api/friends/nudge/:friendId",
          "GET /api/friends/search?q=username"
        ]
      },
      {
        "name": "streak-detail",
        "route": "app/(protected)/streak/[id].tsx",
        "description": "Detailed streak view with a specific friend (#0A0A0A bg). Top: back arrow + friend avatar (48px) + username (text-white font-bold text-lg) + streak badge ('üî• 47 days' bg-[#FF6B35]/20 text-[#FF6B35] rounded-full px-3 py-1). Stats row below: 'Longest: 89' | 'Recoveries: 1' | 'Photos: 214' (each in bg-white/5 rounded-xl p-3, number in text-white text-xl font-bold, label in text-white/50 text-xs). Calendar heatmap section: 'Streak Calendar' header. Grid of last 90 days (7 columns for weekdays). Each cell is 36x36 rounded-lg. Colors: no photo #1C1C1E, your photo only #FF6B35/30, friend only #FF6B35/30, both posted #FF6B35, streak broken #EF4444/30. Month labels at top (text-white/30 text-xs). Photo timeline below calendar: vertical list of date sections. Each date header (text-white/60 text-sm). Side-by-side photos (your photo left, friend right, each w-[48%] aspect-square rounded-xl). Tapping a photo opens full-screen modal. Recovery token section at bottom if streak is at risk: 'Streak at risk! Use recovery token?' ‚Äî 'Use Token (1 remaining)' button (#FF6B35 bg) or 'Buy Token' if none available.",
        "components": [
          "Image friend avatar",
          "StatsRow",
          "CalendarHeatmap custom component",
          "FlatList photo timeline",
          "Modal full-screen photo viewer",
          "Pressable 'Use Recovery Token'",
          "Pressable 'Buy Token'"
        ],
        "api_calls": [
          "GET /api/streaks/:id",
          "GET /api/streaks/:id/calendar",
          "GET /api/streaks/:id/photos?page=1",
          "POST /api/streaks/:id/recover"
        ]
      },
      {
        "name": "profile",
        "route": "app/(protected)/profile.tsx",
        "description": "User profile and stats (#0A0A0A bg). Top: 'Profile' title left, settings gear (Ionicons 'settings-outline' 24px white) right. Avatar section: large avatar (80px circle, border-2 border-[#FF6B35]), tap to change (camera/gallery action sheet). Username below (text-white text-xl font-bold). '@username' handle (text-white/50). Stats cards row: 'Active Streaks' (count in text-[#FF6B35] text-3xl font-bold), 'Longest Streak' (count), 'Total Snaps' (count) ‚Äî each in bg-white/5 rounded-2xl p-4 flex-1. Achievements section: 'Achievements' header (text-white text-lg font-bold). Horizontal ScrollView of achievement badges: '7 Day Warrior' (bronze ring), '30 Day Legend' (silver ring), '100 Day Immortal' (gold ring), 'First Recovery' (shield icon), 'Prompt Master' (camera icon). Locked achievements are grayscale with lock overlay. Recovery Tokens section: 'Recovery Tokens' header. Count display (text-[#FF6B35] text-4xl font-bold) + 'tokens available'. 'Earn 1 token every 30-day streak milestone' subtext. 'Buy More Tokens' button (border border-[#FF6B35] text-[#FF6B35] rounded-xl h-11). Milestone sharing: 'Share Your Stats' button ‚Üí generates Instagram Story / TikTok card with stats overlay on gradient background (#FF6B35 ‚Üí #FF3D00). Bottom: full calendar heatmap of ALL streaks combined (365 days).",
        "components": [
          "Image avatar with edit overlay",
          "StatsCardRow",
          "ScrollView AchievementBadge",
          "RecoveryTokenDisplay",
          "Pressable 'Buy More Tokens'",
          "Pressable 'Share Your Stats'",
          "CalendarHeatmap yearly",
          "Pressable settings gear"
        ],
        "api_calls": [
          "GET /api/users/me/profile",
          "GET /api/users/me/achievements",
          "GET /api/users/me/stats",
          "GET /api/users/me/calendar",
          "PUT /api/users/me/avatar (multipart/form-data)"
        ]
      },
      {
        "name": "settings",
        "route": "app/(protected)/settings.tsx",
        "description": "Settings screen (#0A0A0A bg). Section groups with headers (text-white/50 text-xs uppercase tracking-wider mb-2 mt-6 px-4). Account section: 'Edit Profile' row (navigate to edit-profile), 'Notification Preferences' row (navigate to notification-settings). Subscription section: current plan badge ('Free' in text-white/50 or 'Pro' in text-[#FF6B35]) + 'Manage Subscription' row. 'Restore Purchases' row (triggers RevenueCat restore). Privacy section: 'Privacy Policy' row, 'Terms of Service' row. Support section: 'Help & FAQ' row, 'Contact Us' row (opens email). Danger zone section: 'Log Out' row (text-[#EF4444], confirmation alert). 'Delete Account' row (text-[#EF4444], requires password modal ‚Üí calls DELETE /api/auth/account). Each row: bg-white/5 h-14 px-4 flex-row items-center justify-between, text-white, chevron-right icon (Ionicons 'chevron-forward' 20px white/30). Rows grouped with rounded-2xl overflow hidden.",
        "components": [
          "Pressable setting rows",
          "Alert confirmation for logout",
          "Modal password confirmation for delete",
          "Pressable 'Restore Purchases'"
        ],
        "api_calls": [
          "POST /api/auth/logout",
          "DELETE /api/auth/account",
          "RevenueCat restorePurchases()"
        ]
      },
      {
        "name": "paywall",
        "route": "app/(protected)/paywall.tsx",
        "description": "Pro subscription paywall (#0A0A0A bg). Triggered contextually: after streak break (recovery upsell), at 4th friend add (streak limit), or from settings. Top: close X button (Ionicons 'close' 28px white) right. Hero section: gradient background (#FF6B35 ‚Üí #FF3D00 ‚Üí transparent) top 40% of screen. Large emoji/illustration of fire + shield. Headline: 'Never Lose a Streak Again' (text-white text-2xl font-bold text-center). Subtext: 'StreakSnap Pro gives you the tools to keep every streak alive' (text-white/70 text-center). Feature list with checkmarks: '‚úÖ Unlimited active streaks' / '‚úÖ 3 recovery tokens per month' / '‚úÖ Custom photo prompts' / '‚úÖ Streak analytics & insights' / '‚úÖ Ad-free experience' ‚Äî each row: Ionicons 'checkmark-circle' 24px #22C55E + text-white text-base. Pricing cards (3 options): Weekly $2.99/wk (bg-white/5 border border-white/10 rounded-2xl p-4), Monthly $4.99/mo (bg-white/5 border-2 border-[#FF6B35] rounded-2xl p-4, 'POPULAR' badge bg-[#FF6B35] text-white text-xs rounded-full px-2 py-0.5), Annual $39.99/yr (bg-white/5 border border-white/10 rounded-2xl p-4, 'SAVE 38%' badge). Selected card: border-[#FF6B35] scale 1.02. 'Subscribe' button (bg-[#FF6B35] h-14 rounded-2xl w-full text-white font-bold text-lg). 'Restore Purchases' link (text-white/50 text-sm). Legal text at bottom (text-white/30 text-xs, auto-renew disclaimer).",
        "components": [
          "LinearGradient hero",
          "FeatureCheckmarkList",
          "Pressable PricingCard x3",
          "Pressable 'Subscribe'",
          "Pressable 'Restore Purchases'",
          "Pressable close X"
        ],
        "api_calls": [
          "RevenueCat getOfferings()",
          "RevenueCat purchasePackage()",
          "RevenueCat restorePurchases()"
        ]
      },
      {
        "name": "notifications",
        "route": "app/(protected)/notifications.tsx",
        "description": "Notification center (#0A0A0A bg). Top: 'Notifications' title (text-white text-2xl font-bold) + 'Mark All Read' link (text-[#FF6B35] text-sm). FlatList of notification items. Types: streak_snap (friend posted ‚Äî avatar + 'Sarah sent a snap in your streak üî•' + time ago), streak_risk ('‚ö†Ô∏è Your streak with Jake expires in 2 hours!' ‚Äî bg-[#EF4444]/10 border-l-4 border-[#EF4444]), streak_broken ('üíî Your 23-day streak with Emma broke' ‚Äî bg-[#EF4444]/10), streak_milestone ('üéâ 30-day streak with Alex! You earned a recovery token' ‚Äî bg-[#22C55E]/10), friend_request ('üëã Mike wants to be friends' + Accept/Decline buttons), nudge ('üëâ Sarah nudged you! Time to snap'). Each item: bg-white/5 rounded-xl p-4 mx-4 mb-2. Unread items have left border-2 border-[#FF6B35]. Tapping navigates to relevant screen. Pull-to-refresh. Empty state: bell icon + 'No notifications yet'.",
        "components": [
          "FlatList NotificationItem",
          "Pressable per notification",
          "RefreshControl pull-to-refresh",
          "Pressable 'Mark All Read'",
          "EmptyState"
        ],
        "api_calls": [
          "GET /api/notifications?page=1",
          "PUT /api/notifications/read-all",
          "PUT /api/notifications/:id/read"
        ]
      },
      {
        "name": "share-milestone",
        "route": "app/(protected)/share-milestone/[streakId].tsx",
        "description": "Milestone sharing screen for generating Instagram/TikTok cards (#0A0A0A bg). Top: back arrow + 'Share Milestone' title. Card preview (ViewShot for screenshot capture): gradient background (#FF6B35 ‚Üí #FF3D00), center: 'üî•' large emoji (64px), streak count in massive text (text-white text-6xl font-bold), 'DAY STREAK' subtitle (text-white/80 text-xl), your avatar + friend avatar side by side (48px circles with white border), '@you & @friend' names below, 'StreakSnap' watermark at bottom (text-white/40 text-sm). Card style selector: horizontal ScrollView of 4 card template thumbnails (gradient variations: orange, purple #7C3AED‚Üí#4F46E5, green #22C55E‚Üí#166534, dark #1C1C1E‚Üí#0A0A0A). 'Share to Instagram Stories' button (bg-gradient-to-r from-purple-500 to-pink-500 h-14 rounded-2xl). 'Share to TikTok' button (bg-black border border-white/20 h-14 rounded-2xl). 'Save to Photos' button (bg-white/10 h-14 rounded-2xl). 'Copy Link' button (bg-white/10 h-12 rounded-xl).",
        "components": [
          "ViewShot card preview",
          "LinearGradient card backgrounds",
          "ScrollView template selector",
          "Pressable 'Share to Instagram'",
          "Pressable 'Share to TikTok'",
          "Pressable 'Save to Photos'",
          "Pressable 'Copy Link'"
        ],
        "api_calls": [
          "GET /api/streaks/:streakId/milestone-data"
        ]
      },
      {
        "name": "notification-settings",
        "route": "app/(protected)/notification-settings.tsx",
        "description": "Notification preferences screen (#0A0A0A bg). Top: back arrow + 'Notifications' title. Section: 'Snap Window' ‚Äî 'Window alerts' toggle (when snap window opens), 'Window closing soon' toggle (30min before window closes). Section: 'Streaks' ‚Äî 'Streak at risk' toggle (2h before expiry), 'Streak broken' toggle, 'Friend posted' toggle, 'Milestone reached' toggle. Section: 'Social' ‚Äî 'Friend requests' toggle, 'Nudges' toggle. Each toggle row: bg-white/5 h-14 px-4 flex-row items-center justify-between rounded-xl mb-2. Label text-white, Switch trackColor inactive #3A3A3C active #FF6B35, thumbColor white. Section headers: text-white/50 text-xs uppercase tracking-wider mb-2 mt-6.",
        "components": [
          "Switch toggles per notification type",
          "View section groups"
        ],
        "api_calls": [
          "GET /api/users/me/notification-preferences",
          "PUT /api/users/me/notification-preferences"
        ]
      }
    ],
    "flows": [
      {
        "name": "onboarding",
        "steps": [
          "index",
          "onboarding",
          "guest-home OR register/login"
        ],
        "description": "First launch: index checks AsyncStorage 'onboarding_complete'. If false ‚Üí onboarding screen (3 swipeable steps). After onboarding, user can 'Get Started' ‚Üí register screen, or 'Continue as Guest' ‚Üí guest-home with 3 free peeks. Guest-home blurred cards entice signup. At 0 remaining uses, modal forces register/login."
      },
      {
        "name": "authentication",
        "steps": [
          "login",
          "register",
          "protected-layout/home"
        ],
        "description": "Login with email/password or Apple Sign In. Register with username uniqueness check + password strength. Both flows ‚Üí auto-navigate to protected/home. Refresh token rotation handled by Axios interceptor in lib/api.ts. Token stored in expo-secure-store."
      },
      {
        "name": "daily-snap",
        "steps": [
          "home (see prompt + window banner)",
          "camera (capture photo)",
          "camera (select friends to send to)",
          "home (see updated feed)"
        ],
        "description": "Core loop: User sees today's prompt on home screen. If snap window is active, pulsing orange banner shows remaining time. User taps prompt card or camera tab ‚Üí camera screen with live preview + today's prompt overlay. After capture, user selects which streak friends to send to (or 'Send to All'). Photo uploads via multipart POST. Returns to home feed where their snap now appears in friend cards. Friends who haven't posted yet show '‚è≥ Waiting' placeholder."
      },
      {
        "name": "streak-management",
        "steps": [
          "friends (view active streaks)",
          "streak-detail/[id] (calendar + photos)",
          "share-milestone/[streakId] (share card)"
        ],
        "description": "From friends tab, user sees all active streaks with status pills (both posted / waiting / at risk). Tapping a streak ‚Üí streak detail screen with calendar heatmap, photo timeline, stats, and recovery token option. At milestones (7, 30, 100 days), user can navigate to share-milestone to generate and share Instagram/TikTok cards. If streak is at risk, recovery token prompt appears."
      },
      {
        "name": "friend-management",
        "steps": [
          "friends (search/add)",
          "friends (accept requests)",
          "friends (start streak)"
        ],
        "description": "User taps add icon ‚Üí modal with username search. Send friend request. Recipient sees request in 'Requests' tab + push notification. After accepting, either user can tap 'Start Streak' to initiate a new streak. Existing friends visible in 'All Friends' tab. Active streaks shown in 'Active Streaks' tab with swipe-to-nudge."
      },
      {
        "name": "streak-recovery",
        "steps": [
          "notification (streak at risk)",
          "streak-detail/[id]",
          "recovery confirmation OR paywall"
        ],
        "description": "When streak is about to break (2h before window closes and one person hasn't posted), both users get push notification with loss aversion copy ('Your 47-day streak with Sarah is about to break! üò±'). User opens streak detail. If they have a recovery token (earned 1 per 30-day milestone), they can use it to save the streak. If no tokens, 'Buy Token' navigates to paywall. Recovery extends the window by 24 hours for that specific streak."
      },
      {
        "name": "settings-and-account",
        "steps": [
          "profile (tap gear icon)",
          "settings",
          "notification-settings OR paywall OR delete-account"
        ],
        "description": "From profile screen, gear icon ‚Üí settings. Sections for account management, subscription (with restore purchases), notification preferences, privacy/legal, and danger zone (logout + delete account with password confirmation). Delete account requires modal password entry then calls DELETE /api/auth/account."
      },
      {
        "name": "contextual-paywall",
        "steps": [
          "trigger moment ‚Üí paywall ‚Üí subscribe OR dismiss"
        ],
        "description": "Paywall appears at high-value 'win' moments for maximum conversion: (1) After a streak breaks ‚Äî 'Never lose a streak again' with recovery token highlight, (2) When trying to add 4th active streak on free plan ‚Äî 'Unlimited streaks with Pro', (3) From settings ‚Äî 'Manage Subscription'. Each trigger passes context to paywall for personalized headline. 3 pricing tiers: weekly $2.99, monthly $4.99 (highlighted), annual $39.99 (38% savings). RevenueCat handles purchase + receipt validation ‚Üí backend webhook updates subscription status."
      }
    ],
    "navigation_type": "custom_tab_bar",
    "tab_bar_items": [
      {
        "label": "Home",
        "icon": "home",
        "icon_outline": "home-outline",
        "route": "home",
        "active_color": "#FF6B35",
        "inactive_color": "#FFFFFF60"
      },
      {
        "label": "Camera",
        "icon": "camera",
        "icon_outline": "camera-outline",
        "route": "camera",
        "active_color": "#FF6B35",
        "inactive_color": "#FFFFFF60",
        "is_primary": true,
        "style_override": "bg-[#FF6B35] w-14 h-14 rounded-full -mt-6 items-center justify-center shadow-lg shadow-[#FF6B35]/30"
      },
      {
        "label": "Friends",
        "icon": "people",
        "icon_outline": "people-outline",
        "route": "friends",
        "active_color": "#FF6B35",
        "inactive_color": "#FFFFFF60"
      },
      {
        "label": "Profile",
        "icon": "person",
        "icon_outline": "person-outline",
        "route": "profile",
        "active_color": "#FF6B35",
        "inactive_color": "#FFFFFF60"
      }
    ],
    "mermaid_diagram": "graph TD\n    A[App Launch - index.tsx] -->|First Launch| B[Onboarding 3 Steps]\n    A -->|Returning + No Auth| C[Guest Home]\n    A -->|Authenticated| D[Protected Home]\n    \n    B -->|Get Started| E[Register]\n    B -->|Skip ‚Üí Guest| C\n    C -->|3 uses exhausted| F[Login / Register Modal]\n    C -->|Sign Up CTA| E\n    \n    E -->|Success + Auto-login| D\n    F -->|Login| G[Login]\n    G -->|Success| D\n    F -->|Register| E\n    G -->|Apple Sign In| D\n    E -->|Apple Sign In| D\n    \n    D -->|See Today's Prompt| H[Camera]\n    D -->|Tap Notification Bell| I[Notifications]\n    D -->|Tab: Friends| J[Friends]\n    D -->|Tab: Profile| K[Profile]\n    \n    H -->|Capture + Select Friends| H2[Send Snap]\n    H2 -->|Upload Success| D\n    \n    J -->|Tap Streak| L[Streak Detail]\n    J -->|Add Friend| J2[Search + Send Request]\n    J -->|Accept Request| J3[Start Streak]\n    J -->|Swipe Nudge| J4[Send Nudge Push]\n    \n    L -->|View Calendar Heatmap| L\n    L -->|Streak at Risk| M{Has Recovery Token?}\n    M -->|Yes| N[Use Token - Extend 24h]\n    M -->|No| O[Paywall - Buy Token]\n    L -->|Milestone Reached| P[Share Milestone Card]\n    P -->|Instagram Stories| P2[Share]\n    P -->|TikTok| P3[Share]\n    P -->|Save to Photos| P4[Save]\n    \n    K -->|Gear Icon| Q[Settings]\n    K -->|Share Stats| P\n    Q -->|Notification Prefs| R[Notification Settings]\n    Q -->|Manage Subscription| O\n    Q -->|Logout| G\n    Q -->|Delete Account| S[Password Modal ‚Üí DELETE]\n    \n    I -->|Streak at Risk| L\n    I -->|Friend Posted| D\n    I -->|Friend Request| J\n    I -->|Milestone| P\n    \n    O -->|Subscribe| T[RevenueCat Purchase]\n    T -->|Success| D\n    O -->|Restore| T2[RevenueCat Restore]"
  },
  "backend_spec": {
    "models": [
      {
        "name": "User",
        "table": "users",
        "fields": {
          "ID": "uuid;default:gen_random_uuid();primaryKey",
          "Email": "string;uniqueIndex;not null",
          "PasswordHash": "string",
          "AppleUserID": "string;uniqueIndex;default:null",
          "DisplayName": "string;size:50;not null",
          "AvatarURL": "string;default:null",
          "IsPremium": "bool;default:false",
          "RecoveryTokens": "int;default:0",
          "PushToken": "string;default:null",
          "NotificationWindowStart": "int;default:10;comment:hour of day 0-23 for notification window",
          "TimezoneOffset": "int;default:0;comment:UTC offset in minutes",
          "CreatedAt": "time.Time",
          "UpdatedAt": "time.Time",
          "DeletedAt": "gorm.DeletedAt;index"
        }
      },
      {
        "name": "RefreshToken",
        "table": "refresh_tokens",
        "fields": {
          "ID": "uuid;default:gen_random_uuid();primaryKey",
          "UserID": "uuid;not null;index",
          "TokenHash": "string;uniqueIndex;not null",
          "ExpiresAt": "time.Time;not null",
          "CreatedAt": "time.Time",
          "DeletedAt": "gorm.DeletedAt;index"
        },
        "relations": {
          "User": "belongsTo User"
        }
      },
      {
        "name": "Friendship",
        "table": "friendships",
        "fields": {
          "ID": "uuid;default:gen_random_uuid();primaryKey",
          "RequesterID": "uuid;not null;index",
          "ReceiverID": "uuid;not null;index",
          "Status": "string;size:20;default:pending;comment:pending|accepted|declined|blocked",
          "CreatedAt": "time.Time",
          "UpdatedAt": "time.Time",
          "DeletedAt": "gorm.DeletedAt;index"
        },
        "relations": {
          "Requester": "belongsTo User (RequesterID)",
          "Receiver": "belongsTo User (ReceiverID)"
        },
        "indexes": [
          "uniqueIndex:idx_friendship_pair,columns:requester_id,receiver_id"
        ]
      },
      {
        "name": "Streak",
        "table": "streaks",
        "fields": {
          "ID": "uuid;default:gen_random_uuid();primaryKey",
          "UserAID": "uuid;not null;index",
          "UserBID": "uuid;not null;index",
          "CurrentCount": "int;default:0",
          "LongestCount": "int;default:0",
          "LastCompletedDate": "string;size:10;comment:YYYY-MM-DD",
          "Status": "string;size:20;default:active;comment:active|broken|recovered",
          "BrokenByUserID": "uuid;default:null;comment:who missed the photo",
          "RecoveryUsed": "bool;default:false",
          "StartedAt": "time.Time;not null",
          "BrokenAt": "time.Time;default:null",
          "CreatedAt": "time.Time",
          "UpdatedAt": "time.Time",
          "DeletedAt": "gorm.DeletedAt;index"
        },
        "relations": {
          "UserA": "belongsTo User (UserAID)",
          "UserB": "belongsTo User (UserBID)"
        },
        "indexes": [
          "uniqueIndex:idx_streak_pair,columns:user_a_id,user_b_id"
        ]
      },
      {
        "name": "DailyPhoto",
        "table": "daily_photos",
        "fields": {
          "ID": "uuid;default:gen_random_uuid();primaryKey",
          "UserID": "uuid;not null;index",
          "StreakID": "uuid;not null;index",
          "PromptID": "uuid;default:null",
          "PhotoURL": "string;not null",
          "ThumbnailURL": "string;default:null",
          "PhotoDate": "string;size:10;not null;comment:YYYY-MM-DD",
          "CapturedAt": "time.Time;not null;comment:actual capture timestamp",
          "Caption": "string;size:200;default:null",
          "CreatedAt": "time.Time",
          "DeletedAt": "gorm.DeletedAt;index"
        },
        "relations": {
          "User": "belongsTo User",
          "Streak": "belongsTo Streak",
          "Prompt": "belongsTo DailyPrompt (PromptID)"
        },
        "indexes": [
          "uniqueIndex:idx_daily_photo_unique,columns:user_id,streak_id,photo_date"
        ]
      },
      {
        "name": "DailyPrompt",
        "table": "daily_prompts",
        "fields": {
          "ID": "uuid;default:gen_random_uuid();primaryKey",
          "PromptText": "string;size:100;not null;comment:e.g. Show your lunch",
          "Category": "string;size:30;not null;comment:food|color|view|mood|object|activity",
          "ActiveDate": "string;size:10;uniqueIndex;not null;comment:YYYY-MM-DD",
          "Emoji": "string;size:10;not null;comment:prompt icon emoji",
          "CreatedAt": "time.Time"
        }
      },
      {
        "name": "StreakCalendarEntry",
        "table": "streak_calendar_entries",
        "fields": {
          "ID": "uuid;default:gen_random_uuid();primaryKey",
          "UserID": "uuid;not null;index",
          "StreakID": "uuid;not null;index",
          "EntryDate": "string;size:10;not null;comment:YYYY-MM-DD",
          "Completed": "bool;default:false",
          "PartnerCompleted": "bool;default:false",
          "CreatedAt": "time.Time"
        },
        "relations": {
          "User": "belongsTo User",
          "Streak": "belongsTo Streak"
        },
        "indexes": [
          "uniqueIndex:idx_calendar_unique,columns:user_id,streak_id,entry_date"
        ]
      },
      {
        "name": "RecoveryTransaction",
        "table": "recovery_transactions",
        "fields": {
          "ID": "uuid;default:gen_random_uuid();primaryKey",
          "UserID": "uuid;not null;index",
          "StreakID": "uuid;not null;index",
          "Type": "string;size:20;not null;comment:earned|purchased|used",
          "Amount": "int;not null;comment:positive for earn/purchase, negative for use",
          "BalanceAfter": "int;not null",
          "Note": "string;size:200;default:null",
          "CreatedAt": "time.Time"
        },
        "relations": {
          "User": "belongsTo User",
          "Streak": "belongsTo Streak"
        }
      },
      {
        "name": "NotificationLog",
        "table": "notification_logs",
        "fields": {
          "ID": "uuid;default:gen_random_uuid();primaryKey",
          "UserID": "uuid;not null;index",
          "StreakID": "uuid;default:null;index",
          "Type": "string;size:30;not null;comment:daily_window|streak_at_risk|streak_broken|milestone|friend_request",
          "Title": "string;size:100;not null",
          "Body": "string;size:300;not null",
          "SentAt": "time.Time;not null",
          "ReadAt": "time.Time;default:null",
          "CreatedAt": "time.Time"
        },
        "relations": {
          "User": "belongsTo User",
          "Streak": "belongsTo Streak"
        }
      },
      {
        "name": "MilestoneShare",
        "table": "milestone_shares",
        "fields": {
          "ID": "uuid;default:gen_random_uuid();primaryKey",
          "UserID": "uuid;not null;index",
          "StreakID": "uuid;not null;index",
          "MilestoneCount": "int;not null;comment:7,14,30,50,100,365",
          "CardImageURL": "string;not null;comment:generated share card image",
          "SharePlatform": "string;size:20;default:null;comment:instagram|tiktok|general",
          "SharedAt": "time.Time;default:null",
          "CreatedAt": "time.Time"
        },
        "relations": {
          "User": "belongsTo User",
          "Streak": "belongsTo Streak"
        }
      },
      {
        "name": "Subscription",
        "table": "subscriptions",
        "fields": {
          "ID": "uuid;default:gen_random_uuid();primaryKey",
          "UserID": "uuid;not null;index",
          "RevenueCatID": "string;uniqueIndex;not null",
          "ProductID": "string;size:50;not null",
          "Status": "string;size:20;not null;comment:active|expired|cancelled|billing_retry",
          "ExpiresAt": "time.Time",
          "CreatedAt": "time.Time",
          "UpdatedAt": "time.Time",
          "DeletedAt": "gorm.DeletedAt;index"
        },
        "relations": {
          "User": "belongsTo User"
        }
      },
      {
        "name": "Report",
        "table": "reports",
        "fields": {
          "ID": "uuid;default:gen_random_uuid();primaryKey",
          "ReporterID": "uuid;not null;index",
          "ReportedUserID": "uuid;not null;index",
          "PhotoID": "uuid;default:null",
          "Reason": "string;size:50;not null;comment:inappropriate|spam|harassment|other",
          "Description": "string;size:500;default:null",
          "Status": "string;size:20;default:pending;comment:pending|reviewed|actioned|dismissed",
          "ReviewedAt": "time.Time;default:null",
          "CreatedAt": "time.Time",
          "UpdatedAt": "time.Time",
          "DeletedAt": "gorm.DeletedAt;index"
        },
        "relations": {
          "Reporter": "belongsTo User (ReporterID)",
          "ReportedUser": "belongsTo User (ReportedUserID)",
          "Photo": "belongsTo DailyPhoto (PhotoID)"
        }
      },
      {
        "name": "Block",
        "table": "blocks",
        "fields": {
          "ID": "uuid;default:gen_random_uuid();primaryKey",
          "BlockerID": "uuid;not null;index",
          "BlockedID": "uuid;not null;index",
          "CreatedAt": "time.Time",
          "DeletedAt": "gorm.DeletedAt;index"
        },
        "relations": {
          "Blocker": "belongsTo User (BlockerID)",
          "Blocked": "belongsTo User (BlockedID)"
        },
        "indexes": [
          "uniqueIndex:idx_block_pair,columns:blocker_id,blocked_id"
        ]
      }
    ],
    "endpoints": [
      {
        "method": "GET",
        "path": "/api/health",
        "description": "Health check ‚Äî returns {\"status\": \"ok\", \"db\": true/false, \"version\": \"1.0.0\", \"timestamp\": \"ISO8601\"}",
        "auth_required": false,
        "request_body": null,
        "response_body": "{\"status\": \"ok\", \"db\": true, \"version\": \"1.0.0\", \"timestamp\": \"2026-02-14T12:00:00Z\"}"
      },
      {
        "method": "POST",
        "path": "/api/auth/register",
        "description": "Register with email+password. Hashes password with bcrypt. Returns access_token (15min) + refresh_token (7d). Sets display_name from email prefix if not provided.",
        "auth_required": false,
        "request_body": "{\"email\": \"string (required, valid email)\", \"password\": \"string (required, min 8 chars)\", \"display_name\": \"string (optional, max 50)\"}",
        "response_body": "{\"user\": {\"id\": \"uuid\", \"email\": \"string\", \"display_name\": \"string\", \"is_premium\": false, \"recovery_tokens\": 0}, \"access_token\": \"jwt\", \"refresh_token\": \"string\"}"
      },
      {
        "method": "POST",
        "path": "/api/auth/login",
        "description": "Login with email+password. Returns new token pair. Validates bcrypt hash.",
        "auth_required": false,
        "request_body": "{\"email\": \"string\", \"password\": \"string\"}",
        "response_body": "{\"user\": {\"id\": \"uuid\", \"email\": \"string\", \"display_name\": \"string\", \"is_premium\": bool, \"recovery_tokens\": int, \"avatar_url\": \"string|null\"}, \"access_token\": \"jwt\", \"refresh_token\": \"string\"}"
      },
      {
        "method": "POST",
        "path": "/api/auth/apple",
        "description": "Sign in with Apple. Validates identity_token against Apple JWKS (https://appleid.apple.com/auth/keys). Creates user if new (apple_user_id). Returns token pair.",
        "auth_required": false,
        "request_body": "{\"identity_token\": \"string (required, Apple JWT)\", \"full_name\": \"string (optional, only sent on first auth)\"}",
        "response_body": "{\"user\": {\"id\": \"uuid\", \"email\": \"string\", \"display_name\": \"string\", \"is_premium\": bool, \"recovery_tokens\": int}, \"access_token\": \"jwt\", \"refresh_token\": \"string\", \"is_new_user\": bool}"
      },
      {
        "method": "POST",
        "path": "/api/auth/refresh",
        "description": "Rotate refresh token. Validates current refresh token hash, deletes it, issues new pair. Prevents token reuse.",
        "auth_required": false,
        "request_body": "{\"refresh_token\": \"string\"}",
        "response_body": "{\"access_token\": \"jwt\", \"refresh_token\": \"string\"}"
      },
      {
        "method": "POST",
        "path": "/api/auth/logout",
        "description": "Invalidate current refresh token. Soft-deletes the token record.",
        "auth_required": true,
        "request_body": "{\"refresh_token\": \"string\"}",
        "response_body": "{\"message\": \"Logged out successfully\"}"
      },
      {
        "method": "DELETE",
        "path": "/api/auth/account",
        "description": "Delete user account (Apple Guideline 5.1.1). Requires password confirmation for email users. Soft-deletes user, all streaks, photos, friendships. Clears personal data after 30 days via scheduled job.",
        "auth_required": true,
        "request_body": "{\"password\": \"string (required for email users, omit for Apple users)\"}",
        "response_body": "{\"message\": \"Account scheduled for deletion\"}"
      },
      {
        "method": "GET",
        "path": "/api/users/me",
        "description": "Get current user profile including streak stats summary (total_active_streaks, longest_streak, total_photos, recovery_tokens).",
        "auth_required": true,
        "request_body": null,
        "response_body": "{\"user\": {\"id\": \"uuid\", \"email\": \"string\", \"display_name\": \"string\", \"avatar_url\": \"string|null\", \"is_premium\": bool, \"recovery_tokens\": int, \"created_at\": \"ISO8601\"}, \"stats\": {\"total_active_streaks\": int, \"longest_streak\": int, \"total_photos\": int}}"
      },
      {
        "method": "PUT",
        "path": "/api/users/me",
        "description": "Update current user profile. Only provided fields are updated.",
        "auth_required": true,
        "request_body": "{\"display_name\": \"string (optional, max 50)\", \"avatar_url\": \"string (optional)\", \"notification_window_start\": \"int (optional, 0-23, hour of day for 2-hour notification window)\", \"timezone_offset\": \"int (optional, UTC offset in minutes)\"}",
        "response_body": "{\"user\": {\"id\": \"uuid\", \"display_name\": \"string\", \"avatar_url\": \"string|null\", \"notification_window_start\": int, \"timezone_offset\": int}}"
      },
      {
        "method": "PUT",
        "path": "/api/users/me/push-token",
        "description": "Register or update Expo push notification token for the current user.",
        "auth_required": true,
        "request_body": "{\"push_token\": \"string (Expo push token)\"}",
        "response_body": "{\"message\": \"Push token updated\"}"
      },
      {
        "method": "POST",
        "path": "/api/friends/request",
        "description": "Send a friend request. Cannot send to self, blocked users, or duplicate. Creates Friendship with status=pending.",
        "auth_required": true,
        "request_body": "{\"receiver_id\": \"uuid\"}",
        "response_body": "{\"friendship\": {\"id\": \"uuid\", \"requester_id\": \"uuid\", \"receiver_id\": \"uuid\", \"status\": \"pending\", \"created_at\": \"ISO8601\"}}"
      },
      {
        "method": "PUT",
        "path": "/api/friends/:friendship_id/respond",
        "description": "Accept or decline a friend request. Only the receiver can respond. If accepted, automatically creates a Streak with current_count=0 and status=active.",
        "auth_required": true,
        "request_body": "{\"action\": \"accept|decline\"}",
        "response_body": "{\"friendship\": {\"id\": \"uuid\", \"status\": \"accepted|declined\"}, \"streak\": {\"id\": \"uuid\", \"current_count\": 0, \"status\": \"active\"} | null}"
      },
      {
        "method": "GET",
        "path": "/api/friends",
        "description": "List all friends (accepted friendships). Includes basic user info and active streak summary for each friend.",
        "auth_required": true,
        "request_body": null,
        "response_body": "{\"friends\": [{\"user\": {\"id\": \"uuid\", \"display_name\": \"string\", \"avatar_url\": \"string|null\"}, \"friendship_id\": \"uuid\", \"streak\": {\"id\": \"uuid\", \"current_count\": int, \"status\": \"string\", \"my_photo_today\": bool, \"their_photo_today\": bool}}]}"
      },
      {
        "method": "GET",
        "path": "/api/friends/requests",
        "description": "List pending friend requests (both incoming and outgoing). Direction field indicates 'incoming' or 'outgoing'.",
        "auth_required": true,
        "request_body": null,
        "response_body": "{\"requests\": [{\"friendship_id\": \"uuid\", \"user\": {\"id\": \"uuid\", \"display_name\": \"string\", \"avatar_url\": \"string|null\"}, \"direction\": \"incoming|outgoing\", \"created_at\": \"ISO8601\"}]}"
      },
      {
        "method": "DELETE",
        "path": "/api/friends/:friendship_id",
        "description": "Remove a friend. Soft-deletes friendship and breaks the associated streak (sets status=broken, broken_by=null to indicate mutual unfriend).",
        "auth_required": true,
        "request_body": null,
        "response_body": "{\"message\": \"Friend removed\"}"
      },
      {
        "method": "GET",
        "path": "/api/friends/search",
        "description": "Search for users by display_name or email prefix. Returns max 20 results. Excludes blocked users and self. Used for adding new friends.",
        "auth_required": true,
        "request_body": null,
        "response_body": "{\"users\": [{\"id\": \"uuid\", \"display_name\": \"string\", \"avatar_url\": \"string|null\", \"is_friend\": bool, \"request_pending\": bool}]}"
      },
      {
        "method": "GET",
        "path": "/api/streaks",
        "description": "List all active streaks for current user. Includes partner info, today's photo status for both users, and streak-at-risk flag (true if <6 hours remaining and either user hasn't posted).",
        "auth_required": true,
        "request_body": null,
        "response_body": "{\"streaks\": [{\"id\": \"uuid\", \"partner\": {\"id\": \"uuid\", \"display_name\": \"string\", \"avatar_url\": \"string|null\"}, \"current_count\": int, \"longest_count\": int, \"status\": \"active|broken\", \"my_photo_today\": bool, \"partner_photo_today\": bool, \"at_risk\": bool, \"started_at\": \"ISO8601\"}]}"
      },
      {
        "method": "GET",
        "path": "/api/streaks/:streak_id",
        "description": "Get streak detail including full calendar heatmap data (last 90 days), both users' photos for today, and milestone progress toward next badge.",
        "auth_required": true,
        "request_body": null,
        "response_body": "{\"streak\": {\"id\": \"uuid\", \"partner\": {\"id\": \"uuid\", \"display_name\": \"string\", \"avatar_url\": \"string|null\"}, \"current_count\": int, \"longest_count\": int, \"status\": \"string\", \"started_at\": \"ISO8601\", \"next_milestone\": int, \"my_photo_today\": {\"id\": \"uuid\", \"photo_url\": \"string\", \"caption\": \"string|null\", \"captured_at\": \"ISO8601\"} | null, \"partner_photo_today\": {\"id\": \"uuid\", \"photo_url\": \"string\", \"caption\": \"string|null\", \"captured_at\": \"ISO8601\"} | null, \"calendar\": [{\"date\": \"YYYY-MM-DD\", \"my_completed\": bool, \"partner_completed\": bool}]}}"
      },
      {
        "method": "POST",
        "path": "/api/streaks/:streak_id/recover",
        "description": "Use a recovery token to restore a broken streak. Streak must have status=broken and recovery_used=false. Deducts 1 recovery token from user. Both users in the streak can initiate recovery.",
        "auth_required": true,
        "request_body": null,
        "response_body": "{\"streak\": {\"id\": \"uuid\", \"current_count\": int, \"status\": \"active\", \"recovery_used\": true}, \"recovery_tokens_remaining\": int}"
      },
      {
        "method": "POST",
        "path": "/api/photos/upload",
        "description": "Upload a daily photo for a streak. Validates: one photo per user per streak per day, streak must be active, photo must be taken within the notification window (¬±30 min grace). Stores photo via local file storage or S3-compatible. Updates StreakCalendarEntry. If both users have posted today, increments streak count and checks for milestone + recovery token earn (every 30 days).",
        "auth_required": true,
        "request_body": "multipart/form-data: {\"streak_id\": \"uuid (required)\", \"photo\": \"file (required, max 10MB, jpg/png/heic)\", \"caption\": \"string (optional, max 200 chars)\"}",
        "response_body": "{\"photo\": {\"id\": \"uuid\", \"photo_url\": \"string\", \"thumbnail_url\": \"string\", \"photo_date\": \"YYYY-MM-DD\", \"caption\": \"string|null\", \"captured_at\": \"ISO8601\"}, \"streak_updated\": bool, \"new_count\": int, \"milestone_reached\": int|null, \"recovery_token_earned\": bool}"
      },
      {
        "method": "GET",
        "path": "/api/photos/feed",
        "description": "Get today's friend feed ‚Äî photos from all active streaks where the partner has posted today. Ordered by captured_at desc. Only shows photos after the current user has also posted for that streak (mutual reveal). Excludes blocked users.",
        "auth_required": true,
        "request_body": null,
        "response_body": "{\"feed\": [{\"photo\": {\"id\": \"uuid\", \"photo_url\": \"string\", \"thumbnail_url\": \"string\", \"caption\": \"string|null\", \"captured_at\": \"ISO8601\"}, \"user\": {\"id\": \"uuid\", \"display_name\": \"string\", \"avatar_url\": \"string|null\"}, \"streak\": {\"id\": \"uuid\", \"current_count\": int}, \"prompt\": {\"prompt_text\": \"string\", \"emoji\": \"string\"} | null}], \"pending_reveals\": int}"
      },
      {
        "method": "GET",
        "path": "/api/photos/history/:streak_id",
        "description": "Get paginated photo history for a specific streak. Shows both users' photos side by side per day. Paginated by cursor (date).",
        "auth_required": true,
        "request_body": null,
        "response_body": "{\"days\": [{\"date\": \"YYYY-MM-DD\", \"my_photo\": {\"id\": \"uuid\", \"photo_url\": \"string\", \"caption\": \"string|null\"} | null, \"partner_photo\": {\"id\": \"uuid\", \"photo_url\": \"string\", \"caption\": \"string|null\"} | null, \"prompt\": {\"prompt_text\": \"string\", \"emoji\": \"string\"} | null}], \"next_cursor\": \"YYYY-MM-DD|null\"}"
      },
      {
        "method": "GET",
        "path": "/api/prompts/today",
        "description": "Get today's daily photo prompt. If no prompt exists for today, auto-generates from a rotation of 100+ pre-seeded prompts. Includes category and emoji.",
        "auth_required": true,
        "request_body": null,
        "response_body": "{\"prompt\": {\"id\": \"uuid\", \"prompt_text\": \"string\", \"category\": \"string\", \"emoji\": \"string\", \"active_date\": \"YYYY-MM-DD\"}}"
      },
      {
        "method": "GET",
        "path": "/api/streaks/:streak_id/calendar",
        "description": "Get streak calendar heatmap data for a specific month. Returns daily completion status for both users.",
        "auth_required": true,
        "request_body": null,
        "response_body": "{\"month\": \"YYYY-MM\", \"entries\": [{\"date\": \"YYYY-MM-DD\", \"my_completed\": bool, \"partner_completed\": bool, \"both_completed\": bool}], \"month_stats\": {\"total_days\": int, \"both_completed\": int, \"completion_rate\": float}}"
      },
      {
        "method": "GET",
        "path": "/api/recovery/balance",
        "description": "Get current recovery token balance and transaction history (last 20 transactions).",
        "auth_required": true,
        "request_body": null,
        "response_body": "{\"balance\": int, \"transactions\": [{\"id\": \"uuid\", \"type\": \"earned|purchased|used\", \"amount\": int, \"streak_id\": \"uuid\", \"note\": \"string|null\", \"created_at\": \"ISO8601\"}]}"
      },
      {
        "method": "POST",
        "path": "/api/milestones/:streak_id/generate",
        "description": "Generate a shareable milestone card image for a streak achievement. Creates a styled card with streak count, both users' avatars, date range, and app branding. Returns the card image URL.",
        "auth_required": true,
        "request_body": "{\"milestone_count\": \"int (required, one of: 7, 14, 30, 50, 100, 365)\"}",
        "response_body": "{\"milestone\": {\"id\": \"uuid\", \"card_image_url\": \"string\", \"milestone_count\": int, \"streak_id\": \"uuid\", \"share_text\": \"string\"}}"
      },
      {
        "method": "PUT",
        "path": "/api/milestones/:milestone_id/shared",
        "description": "Mark a milestone as shared (for analytics tracking). Updates shared_at timestamp and platform.",
        "auth_required": true,
        "request_body": "{\"platform\": \"instagram|tiktok|general\"}",
        "response_body": "{\"message\": \"Share recorded\"}"
      },
      {
        "method": "GET",
        "path": "/api/notifications",
        "description": "Get notification history (last 50). Includes unread count. Types: daily_window, streak_at_risk, streak_broken, milestone, friend_request.",
        "auth_required": true,
        "request_body": null,
        "response_body": "{\"notifications\": [{\"id\": \"uuid\", \"type\": \"string\", \"title\": \"string\", \"body\": \"string\", \"streak_id\": \"uuid|null\", \"read\": bool, \"sent_at\": \"ISO8601\"}], \"unread_count\": int}"
      },
      {
        "method": "PUT",
        "path": "/api/notifications/read",
        "description": "Mark notifications as read. Accepts array of notification IDs or 'all' to mark all as read.",
        "auth_required": true,
        "request_body": "{\"notification_ids\": [\"uuid\"] | \"all\"}",
        "response_body": "{\"marked_count\": int}"
      },
      {
        "method": "POST",
        "path": "/api/reports",
        "description": "Report a user or photo (Apple Guideline 1.2). Reason must be one of: inappropriate, spam, harassment, other.",
        "auth_required": true,
        "request_body": "{\"reported_user_id\": \"uuid (required)\", \"photo_id\": \"uuid (optional)\", \"reason\": \"string (required)\", \"description\": \"string (optional, max 500)\"}",
        "response_body": "{\"report\": {\"id\": \"uuid\", \"status\": \"pending\", \"created_at\": \"ISO8601\"}}"
      },
      {
        "method": "POST",
        "path": "/api/blocks",
        "description": "Block a user. Automatically breaks any active streak between the two users and removes friendship.",
        "auth_required": true,
        "request_body": "{\"blocked_id\": \"uuid\"}",
        "response_body": "{\"block\": {\"id\": \"uuid\", \"blocked_id\": \"uuid\", \"created_at\": \"ISO8601\"}}"
      },
      {
        "method": "DELETE",
        "path": "/api/blocks/:block_id",
        "description": "Unblock a user. Does not restore the friendship or streak ‚Äî they must re-add.",
        "auth_required": true,
        "request_body": null,
        "response_body": "{\"message\": \"User unblocked\"}"
      },
      {
        "method": "GET",
        "path": "/api/blocks",
        "description": "List all blocked users.",
        "auth_required": true,
        "request_body": null,
        "response_body": "{\"blocks\": [{\"id\": \"uuid\", \"blocked_user\": {\"id\": \"uuid\", \"display_name\": \"string\", \"avatar_url\": \"string|null\"}, \"created_at\": \"ISO8601\"}]}"
      },
      {
        "method": "GET",
        "path": "/api/admin/moderation/reports",
        "description": "List all pending reports. Admin-only endpoint (checks is_admin flag or hardcoded admin user IDs). Paginated with offset/limit.",
        "auth_required": true,
        "request_body": null,
        "response_body": "{\"reports\": [{\"id\": \"uuid\", \"reporter\": {\"id\": \"uuid\", \"display_name\": \"string\"}, \"reported_user\": {\"id\": \"uuid\", \"display_name\": \"string\"}, \"photo_id\": \"uuid|null\", \"reason\": \"string\", \"description\": \"string|null\", \"status\": \"string\", \"created_at\": \"ISO8601\"}], \"total\": int}"
      },
      {
        "method": "PUT",
        "path": "/api/admin/moderation/reports/:report_id",
        "description": "Action a report. Admin-only. Actions: dismiss (no action), warn (send notification to reported user), suspend (soft-delete user for 7 days), ban (permanent soft-delete).",
        "auth_required": true,
        "request_body": "{\"action\": \"dismiss|warn|suspend|ban\", \"admin_note\": \"string (optional)\"}",
        "response_body": "{\"report\": {\"id\": \"uuid\", \"status\": \"reviewed|actioned\", \"reviewed_at\": \"ISO8601\"}}"
      },
      {
        "method": "POST",
        "path": "/api/webhooks/revenuecat",
        "description": "RevenueCat webhook handler. Validates webhook authorization header. Processes events: INITIAL_PURCHASE, RENEWAL, CANCELLATION, EXPIRATION, BILLING_ISSUE_DETECTED. Updates Subscription model and User.IsPremium flag. Idempotent via RevenueCatID unique constraint.",
        "auth_required": false,
        "request_body": "RevenueCat webhook payload (event.type, event.app_user_id, event.product_id, event.expiration_at_ms, etc.)",
        "response_body": "{\"status\": \"ok\"}"
      }
    ],
    "services": [
      "AuthService: Handles user registration (bcrypt hashing), login (credential validation), Apple Sign-In (JWKS validation against https://appleid.apple.com/auth/keys, extract sub+email from identity_token), JWT generation (access_token with 15min expiry containing sub/email/iat/exp claims, signed with HS256), refresh token rotation (generate random 64-char token, store bcrypt hash, delete old on refresh), logout (soft-delete refresh token), account deletion (soft-delete user + cascade to all related records).",
      "FriendshipService: Manages friend requests (validate no self-add, no duplicate, no blocked users), acceptance (update status + auto-create Streak), declining, friend listing (join with User for display info + join with Streak for current count), user search (ILIKE on display_name and email with LIMIT 20, exclude blocked users), unfriending (soft-delete friendship + break associated streak).",
      "StreakService: Core streak lifecycle management. On both users posting: increment current_count, update longest_count if exceeded, set last_completed_date. Streak breaking: runs via scheduled job (cron every hour), checks all active streaks where last_completed_date < yesterday and either user hasn't posted, sets status=broken and broken_by_user_id. Recovery: validates recovery_used=false, deducts 1 token from user, sets status=active, recovery_used=true, keeps current_count. Recovery token earning: awards 1 token per 30-day milestone (count % 30 == 0). At-risk calculation: returns true if current time > 18:00 in user's timezone and either user hasn't posted today.",
      "PhotoService: Handles multipart photo upload with validation (max 10MB, jpg/png/heic), generates thumbnail (300x300), stores to local disk under /uploads/{streak_id}/{date}/{user_id}.jpg (or S3 if configured). Creates DailyPhoto record. Creates/updates StreakCalendarEntry for both users. After successful upload, checks if partner has also posted today ‚Äî if yes, triggers StreakService increment. Validates one-photo-per-streak-per-day constraint via unique index. Feed query: joins DailyPhoto + User + Streak + DailyPrompt for today's date, filtered by active streaks where partner has posted AND current user has also posted (mutual reveal), excludes blocked users, ordered by captured_at DESC.",
      "PromptService: Manages daily photo prompts. Seeds database with 100+ prompts across 6 categories (food, color, view, mood, object, activity) on first run. GetTodayPrompt: checks for existing prompt for today's date, if none exists picks next prompt from rotation (round-robin by category to ensure variety). Examples: ('Show your lunch', 'food', 'üçΩÔ∏è'), ('Something blue', 'color', 'üîµ'), ('Your view right now', 'view', 'üëÄ'), ('How you're feeling', 'mood', 'üòä'), ('Something old', 'object', 'üè∫'), ('What you're doing', 'activity', 'üèÉ').",
      "NotificationService: Manages push notification delivery via Expo Push API (https://exp.host/--/api/v2/push/send). Notification types: (1) daily_window ‚Äî sent at random time within user's 2-hour notification window (notification_window_start to +2h), title: 'üì∏ Time to snap!', body: '{prompt_text} ‚Äî {partner_name} is waiting!'; (2) streak_at_risk ‚Äî sent 3 hours before end of day if user hasn't posted, title: '‚ö†Ô∏è Streak at risk!', body: 'Your {count}-day streak with {partner} expires in 3 hours!'; (3) streak_broken ‚Äî sent when streak breaks, title: 'üíî Streak broken', body: 'Your {count}-day streak with {partner} ended. Use a recovery token to save it!'; (4) milestone ‚Äî sent when milestone reached, title: 'üî• {count}-day streak!', body: 'You and {partner} hit {count} days! Share your achievement!'; (5) friend_request ‚Äî sent on new request, title: 'üëã New friend request', body: '{name} wants to start a streak with you!'. Stores all sent notifications in NotificationLog for in-app history.",
      "MilestoneService: Generates shareable milestone cards as PNG images. Uses Go image/draw package to compose a 1080x1920 card (Instagram Story aspect ratio) with: gradient background (#7C3AED ‚Üí #4F46E5), streak count in large bold text, both users' display names, date range (started_at to now), streak fire emoji pattern, 'Made with StreakSnap' branding. Stores generated image to /uploads/milestones/{milestone_id}.png. Milestones at: 7, 14, 30, 50, 100, 200, 365 days. Tracks share events for analytics (platform, timestamp).",
      "RecoveryService: Manages recovery token economy. Earning: automatically grants 1 token when any streak reaches a 30-day multiple (30, 60, 90...). Creates RecoveryTransaction with type=earned. Purchasing: handled via RevenueCat IAP (recovery_token_pack_3 = $0.99 for 3 tokens, recovery_token_pack_10 = $2.99 for 10 tokens). Using: validates user has >= 1 token, streak is broken, recovery_used is false. Deducts token, creates transaction type=used, calls StreakService to restore. Balance query joins RecoveryTransaction to compute running total.",
      "SubscriptionService: Processes RevenueCat webhook events. INITIAL_PURCHASE: creates Subscription record, sets User.IsPremium=true. RENEWAL: updates Subscription.ExpiresAt, ensures IsPremium=true. CANCELLATION: updates Subscription.Status=cancelled (still active until expiry). EXPIRATION: sets Status=expired, User.IsPremium=false. BILLING_ISSUE_DETECTED: sets Status=billing_retry. Premium benefits: unlimited streaks (free: max 3 active), no ads, exclusive prompts, priority notifications, 1 bonus recovery token/month. Validates webhook auth via shared secret in Authorization header. Idempotent: uses RevenueCatID as unique constraint, skips duplicate events.",
      "ModerationService: Handles content reports (Apple Guideline 1.2). Creates Report records. Admin actions: dismiss (set status=dismissed), warn (send push notification to reported user), suspend (soft-delete user for 7 days, break all their streaks), ban (permanent soft-delete, break all streaks). List reports with pagination, filter by status. Blocking: creates Block record, soft-deletes Friendship between blocker and blocked, breaks active Streak between them, removes blocked user's photos from blocker's feed queries.",
      "SchedulerService: Background goroutine that runs periodic tasks using time.Ticker: (1) Streak break checker ‚Äî every 1 hour, finds all active streaks where last_completed_date < yesterday (in both users' timezones), marks as broken, sends streak_broken notification to both users; (2) Daily notification dispatcher ‚Äî every 15 minutes, finds all users whose current time falls within their notification window and haven't been notified today, sends daily_window push with randomized timing within the 2-hour window; (3) At-risk reminder ‚Äî every 1 hour, finds active streaks where current time > 3 hours before midnight in user's timezone and user hasn't posted, sends streak_at_risk notification; (4) Cleanup ‚Äî daily at 3AM UTC, deletes expired refresh tokens, purges soft-deleted records older than 30 days."
    ]
  },
  "monetization_model": "Freemium ‚Äî free for up to 3 active streaks with friends. Premium ($2.99/month or $19.99/year) unlocks unlimited streaks, custom prompts, streak recovery tokens, and cosmetic streak badges. One-time streak recovery: $0.99. No ads ever.",
  "subscription_tiers": [
    {
      "name": "Free",
      "price": "0",
      "features": [
        "3 uses/day",
        "Basic features",
        "Ads"
      ]
    },
    {
      "name": "Premium",
      "price": "$4.99/month",
      "features": [
        "Unlimited",
        "All features",
        "No ads"
      ]
    },
    {
      "name": "Annual",
      "price": "$39.99/year",
      "features": [
        "All Premium",
        "33% savings"
      ]
    }
  ],
  "tech_stack": {
    "mobile": "Expo SDK 54 + React Native 0.81 + NativeWind v4 + Expo Router v6",
    "backend": "Go-Fiber v2 + GORM + PostgreSQL",
    "auth": "JWT + Sign in with Apple",
    "payments": "RevenueCat",
    "deployment": "Coolify PaaS",
    "ci_cd": "EAS Build + Fastlane"
  },
  "apple_compliance": [
    "4.8 Sign in with Apple",
    "5.1.1 Account Deletion",
    "1.2 UGC Safety (Report + Block)",
    "3.1.1 IAP via RevenueCat",
    "5.1 Privacy Policy"
  ],
  "generated_at": "2026-02-14T12:45:53.319084+00:00",
  "pipeline_version": "1.0.0"
}